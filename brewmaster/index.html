<html>
<head>
<title>Winemaker Brewing Station</title>
<script src="https://cdn.jsdelivr.net/npm/web3@1.7.4/dist/web3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<script src="brewmaster.js"></script>
<link rel="stylesheet" href="style.css" />
</head>
<body>


<!-- Address entry and Metamask reconnect card -->
<div class="cardAddress" id="cardAddress">
	<div style="position: absolute; width: 0%; left: 50%; top: 50%; transform: translate(-50%, -75%); overflow: visible;">
		<!-- Address text input and buttons -->
		<input id="addressEntry" placeholder="Connect or enter a wallet address..." style="width: 325px; transform: translate(-50%, -50%);"></input>
		<div class="button" style="position: absolute; transform: translate(10%, -50%)" onclick="rpcQuery();">Check Address</div>
		<div class="button" style="position: absolute; transform: translate(-110%, -50%)" onclick="web3Query();">
			<div style="position: absolute; left: 50%; transform: translate(-50%, 0);">
				<img src="http://brewmaster.on.fleek.co/rabby.png" style="position: absolute; width: 24px; height: 24px; transform: translate(-32px, 0px);" />
				Connect				
				<img src="http://brewmaster.on.fleek.co/metamask.png" style="position: absolute; width: 24px; height: 24px; transform: translate(8px, 0px);" />
			</div>
		</div>
	</div>
	
	<!-- Winery monitor card -->
	<div class="cardWinery">
		<!-- Menu Panel -->
		<div style="position: absolute; overflow: visible; width: 0px; height: 0px; left: -100px; background-color: green;">
			<div class="sidebuttonL" style="top: 0px; border-radius: 8px 0 0 0;" onclick="showWineryPanel()">Winery</div>
			<div class="sidebuttonL" style="top: 32px;" onclick="showCellarPanel()">Cellar</div>
			<div class="sidebuttonL" style="top: 64px; border-radius: 0 0 0 8px;" onclick="showPressPanel()">Winepress</div>
		</div>
		
		<!-- Grapery Menu Panel -->
		<div style="position: absolute; overflow: visible; width: 0px; height: 0px; right: -0px; background-color: green;">
			<div class="sidebuttonR" style="top: 0px; border-radius: 0 8px 0 0;" onclick="window.open('https://grapefinance.app/', '_blank')"><img src="http://brewmaster.on.fleek.co/gflogo.png" style="width: 20px; height: 20px;" /> Grape Finance</div>
			<div class="sidebuttonR" style="top: 32px;" onclick="window.open('https://winemaker.grapefinance.app/app/Overview', '_blank')"><img src="https://winemaker.grapefinance.app/static/media/image-2.48f392d8.png" style="width: 20px; height: 20px; border-radius: 10px;" /> Winemaker Game</div>
			<div class="sidebuttonR" style="top: 64px; border-radius: 0 0 8px 0;" onclick="window.open('https://winepress.grapefinance.app/', '_blank')"><img src="https://winepress.grapefinance.app/_next/image?url=%2Fimg%2Fbarrel.png&w=48&q=75" style="width: 20px; height: 20px" /> The Winepress</div>
		</div>

		<!-- Brewing Station Header -->
		<div class="title-header">&#127863; Brewing Station &#127863;</div>
		<div style="margin-top: 8px">
			<span class="row-header">Brewer Address:</span><br>
			<span class="row-content"  id="address"></span>
		</div>
		<!-- Winery panel -->
		<div id="WineryPanel" class="panel">
			<div class="panel-header">Winery Manager<br><hr></div>
			<div style="margin: 16px;">
				<div>
					<div class="row-item">
						<div class="row-header" style="width: 110px;">GRAPE:</div>
						<div class="row-content" id="grapeprice"></div>
					</div>
					<div class="row-item">
						<div class="row-header" style="width: 110px;">VINTAGE:</div>
						<div class="row-content" id="vintageprice"></div>
					</div>
				</div>				
				<div style="margin-top: 8px">
					<span class="row-header">Vintage PM:</span>
					<span class="row-content" id="vpm"></span>
				</div>
				<div style="margin-top: 8px">
					<span class="row-header">Max fatigue on </span><span class="row-content" id="fatiguedate100"></span><br>					
					<span class="row-header">50% fatigue on </span><span class="row-content" id="fatiguedate50"></span><br>
					<span class="row-header">Current Fatigue: </span><span class="row-content"  id="fatigue"></span>
				</div>
				<div style="margin-top: 8px">
					<span class="row-header">Reset Fatigue Cost: </span><span class="row-content" id="resetCost"></span>
				</div>
				<div id="vintners" style="margin-top: 8px">
					<span class="row-header">Master Vintners Staked: </span><span class="row-content" id="masters"></span><br>
					<span class="row-header">Normal Vintners Staked: </span><span class="row-content" id="normals"></span>
				</div>
				<div style="margin-top: 8px">
					<div class="row-item">
						<div class="row-header" style="width: 150px">Vintage Earned: </div>
						<div class="row-content" id="vintage"></div>
					</div>
					<div class="row-item">
						<div class="row-header" style="width: 150px">Storage Used:</div>
						<div class="row-content" id="storage"></div>
					</div>
				</div>
				<div style="margin-top: 8px">
					<span class="row-header">50 GRAPE = </span><span class="row-content" id="grapetovint"></span><br>
				</div>
				<div style="margin-top: 8px">
					<span class="row-header">Tools Mint Costs:</span><br>
					<div class="row-item">
						<div class="row-header" style="width: 130px; text-align: right;">Magazine:&nbsp;</div>
						<div class="row-content" id="magazine"></div>
					</div>
					<div class="row-item">
						<div class="row-header" style="width: 130px; text-align: right;">Shears:&nbsp;</div>
						<div class="row-content" id="shears"></div>
					</div>
					<div class ="row-item">
						<div class="row-header" style="width: 130px; text-align: right;">Hydrometer:&nbsp;</div>
						<div class="row-content" id="hydro"></div>
					</div>
				</div>
				<div style="margin: 16px">
					<div class="button" id="resetButton" onClick="resetFatigue();">Reset Fatigue</div>
					<div class="button" id="claimButton" onClick="claimVintage();">Claim $VINTAGE</div>
				</div>
			</div>
		</div>
		
		<!-- Cellar panel -->
		<div id="CellarPanel" class="panel" style="display: none; opacity: 0;">
			<div class="panel-header">Cellar Inventory<br><hr></div>
			<div style="margin: 16px;">
				<div style="margin-top: 16px">
					<div class="row-item">
						<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Ratio: </div>
						<div id="cellarratio" class="row-content"></div>
					</div>
				</div>
				<div>
					<div class="row-header">Wallet -</div>
					<div class="row-item">
						<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">$VINTAGE: </div>
						<div id="vintinwallet" class="row-content"></div>
					</div>
					<div class="row-item">
						<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">$sVINTAGE: </div>
						<div id="svintinwallet" class="row-content"></div>
					</div>
					<div style="margin-top: 8px; display: flex;">
						<div style="width: 45%;">
							<div class="button" onclick="depositVintage()">1. Deposit</div>							
							<div class="evilbutton" onclick="unstakeSVintage()">3. Unstake</div>
						</div>
						<div style="width: 45%; grow-flex: 1;">
							<div class="button" onclick="stakeSVintage()">2. Stake&nbsp;&nbsp;&nbsp;</div>
							<div class="evilbutton" onclick="withdrawVintage()">4. Withdraw</div>
						</div>
					</div>
				</div>			
				<div style="margin-top: 16px">
					<div class="row-header">Vineyard Staking -</div>
					<div class="row-item">
						<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Vineyard: </div>
						<div id="svintinvinyard" class="row-content"></div>
					</div>
					<div class="row-item">
						<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Pending: </div>
						<div id="pendingwine" class="row-content"></div>
					</div>
					<div style="margin-top: 8px">
						<div class="button" onclick="claimVineyardRewards()">Claim Rewards</div>					
					</div>
				</div>				
				<div style="margin-top: 16px">
					<div class="row-header">Pending Claims -</div>
					<div class="row-item">
						<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Amount: </div>
						<div id="cel-pendingamounts" class="row-content"></div>
					</div>
					<div class="row-item">
						<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Claimable on </div>
						<div id="cel-pendingtimestamps" class="row-content"></div>
					</div>
				</div>
				<div style="margin-top: 8px">
					<div class="button" id="cel-claimpending" onclick="claimPendingFromCellar()">Claim Pending</div>					
				</div>
			</div>
		</div>
		
		<!-- Winepress Panel -->
		<div id="PressPanel" class="panel" style="display: none; opacity: 0;">
			<div class="panel-header">Winepress Maintenance<br><hr></div>
			<div style="margin: 16px;">
				<div class="row-item">
					<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">1 WINE-MIM-LP = </div>
					<div id="wp-lpvalue" class="row-content"></div>
				</div>
				<div class="row-item" style="margin-top: 8px;">
					<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Deposits: </div>
					<div id="wp-trackedBalance" class="row-content"></div>
				</div>
				<div class="row-item">
					<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Compounded: </div>
					<div id="wp-compoundedBalance" class="row-content"></div>
				</div>
				<div class="row-item" style="margin-top: 8px;">
					<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Pending Rewards: </div>
					<div id="wp-pendingRewards" class="row-content"></div>
				</div>
				<div class="row-item">
					<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Daily Rewards: </div>
					<div id="wp-dailyRewards" class="row-content"></div>
				</div>
				<div class="row-item" style="margin-top: 8px">
					<div class="row-header" style="text-align: right; transform: translate(-8px, 0px);">Assassination Risk: </div>
					<div id="wp-assassinationrisk" class="row-content"></div>
				</div>
				<div class="button" onclick="claimWinepress()">Claim</div>
				<div class="button" onclick="compoundWinepress()">Compound</div>
			</div>			
		</div>
		
		<!-- Disclaimer card -->
		<!-- If you're reading this CSS really sucks but when you get it to work, it's almost (ALMOST) beautiful... -->
		<div class="cardDisclaimer">
			DISCLAIMER: This tool provides a basic interface into the winery to keep track of stats, it is NOT intended to be a replacement for any GrapeFinance dApp.<br>
			This tool is open-source, you can view the source on the <a href="https://github.com/neoaikon2/WinemakerBrewingStation">GitHub repository</a><br>
			<div style="font-size: 12px; margin-top: 4px;">Brewmaster v2.1</div>
		</div>
	</div>
</div>
</body>
</html>